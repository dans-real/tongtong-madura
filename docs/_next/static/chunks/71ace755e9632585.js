(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,79474,(e,r,a)=>{"use strict";var t=e.r(71645).__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;a.c=function(e){return t.H.useMemoCache(e)}},932,(e,r,a)=>{"use strict";r.exports=e.r(79474)},18566,(e,r,a)=>{r.exports=e.r(76562)},95873,e=>{"use strict";var r=e.i(932),a=e.i(71645);e.i(51718);var t=e.i(18357),l=e.i(59141);function s(){let e,s,d,o=(0,r.c)(5),[i,n]=(0,a.useState)(null),[c,m]=(0,a.useState)(!0);return o[0]===Symbol.for("react.memo_cache_sentinel")?(e=()=>{let e=(0,t.onAuthStateChanged)(l.auth,e=>{n(e),m(!1)});return()=>e()},s=[],o[0]=e,o[1]=s):(e=o[0],s=o[1]),(0,a.useEffect)(e,s),o[2]!==c||o[3]!==i?(d={user:i,loading:c},o[2]=c,o[3]=i,o[4]=d):d=o[4],d}e.s(["useAuth",()=>s])},3085,e=>{"use strict";var r=e.i(43476),a=e.i(71645),t=e.i(18566),l=e.i(95873),s=e.i(59141);e.i(36180);var d=e.i(98925);e.i(61086);var o=e.i(27215);function i(){let e=(0,t.useRouter)(),{user:i,loading:n}=(0,l.useAuth)(),[c,m]=(0,a.useState)([]),[u,g]=(0,a.useState)(!1),[x,b]=(0,a.useState)(null),[h,p]=(0,a.useState)(null),[f,w]=(0,a.useState)(""),[j,y]=(0,a.useState)(""),[N,v]=(0,a.useState)(""),[k,B]=(0,a.useState)(""),[S,E]=(0,a.useState)(""),[F,U]=(0,a.useState)([]),[A,C]=(0,a.useState)(""),[G,D]=(0,a.useState)(""),[P,_]=(0,a.useState)(new Date().getFullYear()),[T,R]=(0,a.useState)(!1),[I,z]=(0,a.useState)(!1);(0,a.useEffect)(()=>{n||i||e.push("/admin")},[i,n,e]),(0,a.useEffect)(()=>{if(!i)return;let e=(0,d.query)((0,d.collection)(s.db,"gallery"),(0,d.orderBy)("createdAt","desc")),r=(0,d.onSnapshot)(e,e=>{let r=[];e.forEach(e=>{r.push({id:e.id,...e.data()})}),m(r)});return()=>r()},[i]);let O=()=>{p(null),w(""),y(""),v(""),B(""),E(""),U([]),C(""),D(""),_(new Date().getFullYear()),R(!1),g(!1),b(null)},L=async e=>{console.log("ðŸ“ File info:",{name:e.name,size:(e.size/1024).toFixed(2)+" KB",type:e.type});try{console.log("ðŸ“¤ Uploading to Firebase Storage...");let r=Date.now(),a=e.name.replace(/[^a-zA-Z0-9.]/g,"_"),t=`gallery/${r}_${a}`,l=(0,o.ref)(s.storage,t),d=await (0,o.uploadBytes)(l,e);console.log("ðŸ“¥ Upload complete:",d.metadata.fullPath);let i=await (0,o.getDownloadURL)(d.ref);return console.log("âœ… Download URL:",i),i}catch(e){if(console.error("âŒ Upload error:",e),"storage/unauthorized"===e.code)throw Error("Tidak memiliki izin upload. Periksa Firebase Storage Rules.");if("storage/canceled"===e.code)throw Error("Upload dibatalkan.");if("storage/unknown"===e.code)throw Error("Terjadi kesalahan. Periksa koneksi internet Anda.");throw Error(e.message||"Gagal upload gambar ke Firebase Storage")}},M=async e=>{if(e.preventDefault(),!u&&!h)return void alert("Please select an image to upload");z(!0);try{let e=j;if(h)try{e=await L(h)}catch(e){console.error("Image upload failed:",e),alert(`âŒ Gagal upload gambar: ${e.message}

Solusi:
1. Cek koneksi internet
2. Pastikan Firebase Storage sudah aktif
3. Periksa Storage Rules di Firebase Console`),z(!1);return}if(u&&x){let r=(0,d.doc)(s.db,"gallery",x),a={title:N,caption:k,tags:F,description:S||k,isFeatured:T,updatedAt:d.Timestamp.now()};A&&(a.region=A),G&&(a.mood=G),P&&(a.year=P),h&&(a.imageUrl=e),await (0,d.updateDoc)(r,a),alert("Gallery item updated!")}else{let r={imageUrl:e,title:N,caption:k,description:S||k,tags:F,isFeatured:T,createdAt:d.Timestamp.now(),updatedAt:d.Timestamp.now()};A&&(r.region=A),G&&(r.mood=G),P&&(r.year=P),await (0,d.addDoc)((0,d.collection)(s.db,"gallery"),r),alert("Gallery item added!")}O()}catch(e){console.error("Error saving gallery item:",e),alert("Error saving item")}finally{z(!1)}},Y=async e=>{if(confirm("Are you sure you want to delete this item?"))try{await (0,d.deleteDoc)((0,d.doc)(s.db,"gallery",e)),alert("Item deleted!")}catch(e){console.error("Error deleting item:",e),alert("Error deleting item")}};return n?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-redBrown-950 text-white",children:"Loading..."}):i?(0,r.jsx)("div",{className:"min-h-screen bg-redBrown-950 p-8",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Gallery Management"}),(0,r.jsx)("button",{onClick:()=>e.push("/admin"),className:"px-4 py-2 bg-redBrown-800 text-white rounded-lg hover:bg-redBrown-700",children:"â† Back to Dashboard"})]}),(0,r.jsxs)("div",{className:"bg-redBrown-900/80 border-2 border-amber-500/50 rounded-2xl p-6 mb-8",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-white mb-4",children:u?"Edit Item":"Add New Item"}),(0,r.jsxs)("form",{onSubmit:M,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-amber-300 mb-2",children:["Upload Image ",!u&&(0,r.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{let r=e.target.files?.[0];if(r){if(r.size>0x2000000){alert("âŒ File terlalu besar!\n\nUkuran maksimal: 32MB\nUkuran file Anda: "+(r.size/1048576).toFixed(2)+"MB\n\nSolusi: Kompres gambar terlebih dahulu"),e.target.value="";return}if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(r.type)){alert("âŒ Format file tidak didukung!\n\nFormat yang diterima: JPG, PNG, GIF, WebP\nFormat file Anda: "+r.type),e.target.value="";return}p(r);let a=new FileReader;a.onloadend=()=>{w(a.result)},a.readAsDataURL(r)}},className:"w-full px-4 py-2 bg-redBrown-800 border border-redBrown-600 rounded-lg text-white file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-maduraGold file:text-redBrown-950 file:font-bold hover:file:bg-amber-400"}),f&&(0,r.jsxs)("div",{className:"mt-3 relative aspect-video bg-redBrown-800 rounded-lg overflow-hidden border-2 border-amber-400",children:[(0,r.jsx)("img",{src:f,alt:"Preview",className:"w-full h-full object-cover"}),(0,r.jsx)("div",{className:"absolute top-2 right-2 bg-maduraGold text-redBrown-950 px-3 py-1 rounded-lg text-xs font-bold",children:"Preview"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-amber-300 mb-2",children:"Title"}),(0,r.jsx)("input",{type:"text",value:N,onChange:e=>v(e.target.value),required:!0,className:"w-full px-4 py-2 bg-redBrown-800 border border-redBrown-600 rounded-lg text-white",placeholder:"Photo title"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-amber-300 mb-2",children:"Caption (Short)"}),(0,r.jsx)("textarea",{value:k,onChange:e=>B(e.target.value),required:!0,rows:2,className:"w-full px-4 py-2 bg-redBrown-800 border border-redBrown-600 rounded-lg text-white",placeholder:"Caption singkat untuk preview card"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-amber-300 mb-2",children:"Description (Optional - untuk detail lebih panjang)"}),(0,r.jsx)("textarea",{value:S,onChange:e=>E(e.target.value),rows:3,className:"w-full px-4 py-2 bg-redBrown-800 border border-redBrown-600 rounded-lg text-white",placeholder:"Deskripsi detail (opsional, jika kosong akan pakai caption)"})]}),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:T,onChange:e=>R(e.target.checked),className:"w-5 h-5 rounded bg-redBrown-800 border-2 border-maduraGold checked:bg-maduraGold checked:border-maduraGold"}),(0,r.jsx)("span",{className:"text-sm font-medium text-amber-300",children:"â­ Mark as Featured (tampil besar di atas)"})]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-amber-300 mb-2",children:"Wilayah Tags (Pilih wilayah yang sesuai)"}),(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:["Bangkalan","Sampang","Pamekasan","Sumenep"].map(e=>(0,r.jsx)("button",{type:"button",onClick:()=>{U(r=>r.includes(e)?r.filter(r=>r!==e):[...r,e])},className:`px-4 py-3 rounded-lg font-semibold transition-all border-2 ${F.includes(e)?"bg-maduraGold text-redBrown-950 border-amber-400 shadow-lg shadow-maduraGold/30":"bg-redBrown-800 text-white border-redBrown-600 hover:border-maduraGold/50"}`,children:e},e))}),(0,r.jsx)("p",{className:"text-xs text-redBrown-400 mt-2",children:F.length>0?`Selected: ${F.join(", ")}`:"Belum ada wilayah dipilih"})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("button",{type:"submit",disabled:I,className:"px-6 py-2 bg-maduraGold text-redBrown-950 font-bold rounded-lg hover:bg-amber-400 border-2 border-amber-400 shadow-lg shadow-maduraGold/30 disabled:opacity-50 disabled:cursor-not-allowed",children:I?"Uploading...":u?"ðŸ’¾ Update Item":"âž• Add Item"}),u&&(0,r.jsx)("button",{type:"button",onClick:O,className:"px-6 py-2 bg-redBrown-700 text-white rounded-lg hover:bg-redBrown-600",children:"Cancel"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-white mb-4",children:["Existing Items (",c.length,")"]}),(0,r.jsx)("div",{className:"grid md:grid-cols-2 gap-4",children:c.map(e=>(0,r.jsxs)("div",{className:"bg-redBrown-900/80 border-2 border-redBrown-700/50 rounded-xl p-4 space-y-3",children:[e.isFeatured&&(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)("span",{className:"px-3 py-1 rounded-full bg-maduraGold text-redBrown-950 text-xs font-bold",children:"â­ FEATURED"})}),(0,r.jsx)("div",{className:"aspect-video bg-redBrown-800 rounded-lg overflow-hidden",children:(0,r.jsx)("img",{src:e.imageUrl,alt:e.title,className:"w-full h-full object-cover"})}),(0,r.jsx)("h3",{className:"text-lg font-bold text-white",children:e.title}),(0,r.jsx)("p",{className:"text-sm text-redBrown-300",children:e.caption}),(0,r.jsxs)("div",{className:"space-y-1 text-xs text-redBrown-400",children:[e.region&&(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-semibold",children:"Primary Region:"})," ",e.region]}),e.mood&&(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-semibold",children:"Mood:"})," ",e.mood]}),e.year&&(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-semibold",children:"Year:"})," ",e.year]})]}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:e.tags.map(e=>(0,r.jsx)("span",{className:"px-3 py-1 bg-amber-400/90 border-2 border-amber-300 rounded-full text-xs text-redBrown-950 font-bold",children:e},e))}),(0,r.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,r.jsx)("button",{onClick:()=>{y(e.imageUrl),w(e.imageUrl),v(e.title),B(e.caption),E(e.description||""),U(e.tags||[]),C(e.region||""),D(e.mood||""),_(e.year||new Date().getFullYear()),R(e.isFeatured||!1),g(!0),b(e.id)},className:"flex-1 px-4 py-2 bg-cyan-500 text-white font-medium rounded-lg hover:bg-cyan-600 border-2 border-cyan-400",children:"Edit"}),(0,r.jsx)("button",{onClick:()=>Y(e.id),className:"flex-1 px-4 py-2 bg-red-600 text-white font-medium rounded-lg hover:bg-red-700 border-2 border-red-500",children:"Delete"})]})]},e.id))})]})]})}):null}e.s(["default",()=>i])}]);